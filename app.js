!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=35)}([function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=n(5),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=f;var o=n(4);o.inherits=n(0);var s=n(13),u=n(10);o.inherits(f,s);for(var a=i(u.prototype),l=0;l<a.length;l++){var c=a[l];f.prototype[c]||(f.prototype[c]=u.prototype[c])}function f(t){if(!(this instanceof f))return new f(t);s.call(this,t),u.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),f.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var a,l=[],c=!1,f=-1;function h(){c&&a&&(c=!1,a.length?l=a.concat(l):f=-1,l.length&&p())}function p(){if(!c){var t=u(h);c=!0;for(var e=l.length;e;){for(a=l,l=[];++f<e;)a&&a[f].run();f=-1,e=l.length}a=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new d(t,e)),1!==l.length||c||u(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(9).Buffer)},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,u=arguments.length;switch(u){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(u-1),s=0;s<o.length;)o[s++]=arguments[s];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,n(3))},function(t,e,n){var r=n(9),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=s),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,s,u,a,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(o(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),n.apply(this,u)}else if(i(n))for(u=Array.prototype.slice.call(arguments,1),s=(l=n.slice()).length,a=0;a<s;a++)l[a].apply(this,u);return!0},n.prototype.addListener=function(t,e){var s;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(s=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,e){var n,o,s,u;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,o=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(u=s;u-- >0;)if(n[u]===e||n[u].listener&&n[u].listener===e){o=u;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){(e=t.exports=n(13)).Stream=e,e.Readable=e,e.Writable=n(10),e.Duplex=n(2),e.Transform=n(17),e.PassThrough=n(28)},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(20),i=n(21),o=n(14);function s(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=a.prototype:(null===t&&(t=new a(e)),t.length=e),t}function a(t,e,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return l(this,t,e,n)}function l(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);a.TYPED_ARRAY_SUPPORT?(t=e).__proto__=a.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=u(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(a.isBuffer(e)){var n=0|p(e.length);return 0===(t=u(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?u(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(c(e),t=u(t,e<0?0:0|p(e)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=u(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(r)return q(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=a.from(e,r)),a.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,i);if("number"==typeof e)return e&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,i){var o,s=1,u=t.length,a=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,u/=2,a/=2,n/=2}function l(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var c=-1;for(o=n;o<u;o++)if(l(t,o)===l(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===a)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(n+a>u&&(n=u-a),o=n;o>=0;o--){for(var f=!0,h=0;h<a;h++)if(l(t,o+h)!==l(e,h)){f=!1;break}if(f)return o}return-1}function m(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var u=parseInt(e.substr(2*s,2),16);if(isNaN(u))return s;t[n+s]=u}return s}function v(t,e,n,r){return $(q(e,t.length-n),t,n,r)}function _(t,e,n,r){return $(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return _(t,e,n,r)}function S(t,e,n,r){return $(F(e),t,n,r)}function O(t,e,n,r){return $(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function j(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,u,a,l=t[i],c=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(o=t[i+1]))&&(a=(31&l)<<6|63&o)>127&&(c=a);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(a=(15&l)<<12|(63&o)<<6|63&s)>2047&&(a<55296||a>57343)&&(c=a);break;case 4:o=t[i+1],s=t[i+2],u=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&u)&&(a=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&u)>65535&&a<1114112&&(c=a)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(t){var e=t.length;if(e<=k)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=k));return n}(r)}e.Buffer=a,e.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},e.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),a.poolSize=8192,a._augment=function(t){return t.__proto__=a.prototype,t},a.from=function(t,e,n){return l(null,t,e,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(t,e,n){return function(t,e,n,r){return c(e),e<=0?u(t,e):void 0!==n?"string"==typeof r?u(t,e).fill(n,r):u(t,e).fill(n):u(t,e)}(null,t,e,n)},a.allocUnsafe=function(t){return f(null,t)},a.allocUnsafeSlow=function(t){return f(null,t)},a.isBuffer=function(t){return!(null==t||!t._isBuffer)},a.compare=function(t,e){if(!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=a.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},a.byteLength=d,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return R(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return j(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t,e,n,r,i){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,u=Math.min(o,s),l=this.slice(r,i),c=t.slice(e,n),f=0;f<u;++f)if(l[f]!==c[f]){o=l[f],s=c[f];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},a.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},a.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},a.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return m(this,t,e,n);case"utf8":case"utf-8":return v(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function R(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=U(t[o]);return i}function x(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function C(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function A(t,e,n,r,i,o){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function I(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function M(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function N(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(t,e,n,r,o){return o||N(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||N(t,0,n,8),i.write(t,e,n,r,52,8),n+8}a.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),a.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=a.prototype;else{var i=e-t;n=new a(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},a.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},a.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},a.prototype.readUInt8=function(t,e){return e||C(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return e||C(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return e||C(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},a.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},a.prototype.readInt8=function(t,e){return e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){e||C(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(t,e){e||C(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(t,e){return e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return e||C(t,4,this.length),i.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return e||C(t,4,this.length),i.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return e||C(t,8,this.length),i.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return e||C(t,8,this.length),i.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||A(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},a.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||A(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},a.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},a.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},a.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},a.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},a.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);A(this,t,e,n,i-1,-i)}var o=0,s=1,u=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===u&&0!==this[e+o-1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+n},a.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);A(this,t,e,n,i-1,-i)}var o=n-1,s=1,u=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===u&&0!==this[e+o+1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+n},a.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},a.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},a.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},a.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},a.prototype.writeFloatLE=function(t,e,n){return D(this,t,e,!0,n)},a.prototype.writeFloatBE=function(t,e,n){return D(this,t,e,!1,n)},a.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},a.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},a.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!a.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},a.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=a.isBuffer(t)?t:q(new a(t,r).toString()),u=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%u]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function q(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(1))},function(t,e,n){"use strict";(function(e,r,i){var o=n(5);function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;t.entry=null;for(;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=m;var u,a=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:o.nextTick;m.WritableState=g;var l=n(4);l.inherits=n(0);var c={deprecate:n(27)},f=n(15),h=n(6).Buffer,p=i.Uint8Array||function(){};var d,y=n(16);function b(){}function g(t,e){u=u||n(2),t=t||{};var r=e instanceof u;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,l=t.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(l||0===l)?l:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var f=!1===t.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(o.nextTick(i,r),o.nextTick(j,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),j(t,e))}(t,n,r,e,i);else{var s=S(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||w(t,n),r?a(_,t,n,s,i):_(t,n,s,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function m(t){if(u=u||n(2),!(d.call(m,this)||this instanceof u))return new m(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),f.call(this)}function v(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function _(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),j(t,e)}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var u=0,a=!0;n;)i[u]=n,n.isBuf||(a=!1),n=n.next,u+=1;i.allBuffers=a,v(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,c=n.encoding,f=n.callback;if(v(t,e,!1,e.objectMode?1:l.length,l,c,f),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function S(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function O(t,e){t._final(function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),j(t,e)})}function j(t,e){var n=S(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(O,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}l.inherits(m,f),g.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(g.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===m&&(t&&t._writableState instanceof g)}})):d=function(t){return t instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(t,e,n){var r=this._writableState,i=!1,s=!r.objectMode&&function(t){return h.isBuffer(t)||t instanceof p}(t);return s&&!h.isBuffer(t)&&(t=function(t){return h.from(t)}(t)),"function"==typeof e&&(n=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=b),r.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),o.nextTick(e,n)}(this,n):(s||function(t,e,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),o.nextTick(r,s),i=!1),i}(this,r,t,n))&&(r.pendingcb++,i=function(t,e,n,r,i,o){if(!n){var s=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=h.from(e,n));return e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var u=e.objectMode?1:r.length;e.length+=u;var a=e.length<e.highWaterMark;a||(e.needDrain=!0);if(e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else v(t,e,!1,u,r,i,o);return a}(this,r,s,t,e,n)),i},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},m.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,j(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),m.prototype.destroy=y.destroy,m.prototype._undestroy=y.undestroy,m.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(3),n(25).setImmediate,n(1))},function(t,e,n){"use strict";var r=n(6).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=a,this.end=l,e=4;break;case"utf8":this.fillLast=u,e=4;break;case"base64":this.text=c,this.end=f,e=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function u(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function a(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function l(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function c(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function f(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){t.exports=i;var r=n(7).EventEmitter;function i(){r.call(this)}n(0)(i,r),i.Readable=n(8),i.Writable=n(29),i.Duplex=n(30),i.Transform=n(31),i.PassThrough=n(32),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",u),n.on("close",a));var s=!1;function u(){s||(s=!0,t.end())}function a(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function l(t){if(c(),0===r.listenerCount(this,"error"))throw t}function c(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",u),n.removeListener("close",a),n.removeListener("error",l),t.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),t.removeListener("close",c)}return n.on("error",l),t.on("error",l),n.on("end",c),n.on("close",c),t.on("close",c),t.emit("pipe",n),t}},function(t,e,n){"use strict";(function(e,r){var i=n(5);t.exports=v;var o,s=n(14);v.ReadableState=m;n(7).EventEmitter;var u=function(t,e){return t.listeners(e).length},a=n(15),l=n(6).Buffer,c=e.Uint8Array||function(){};var f=n(4);f.inherits=n(0);var h=n(22),p=void 0;p=h&&h.debuglog?h.debuglog("stream"):function(){};var d,y=n(23),b=n(16);f.inherits(v,a);var g=["error","close","destroy","pause","resume"];function m(t,e){o=o||n(2),t=t||{};var r=e instanceof o;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,s=t.readableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:u,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=n(11).StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function v(t){if(o=o||n(2),!(this instanceof v))return new v(t);this._readableState=new m(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),a.call(this)}function _(t,e,n,r,i){var o,s=t._readableState;null===e?(s.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,j(t)}(t,s)):(i||(o=function(t,e){var n;(function(t){return l.isBuffer(t)||t instanceof c})(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(s,e)),o?t.emit("error",o):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===l.prototype||(e=function(t){return l.from(t)}(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?w(t,s,e,!1):k(t,s)):w(t,s,e,!1))):r||(s.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function w(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&j(t)),k(t,e)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),v.prototype.destroy=b.destroy,v.prototype._undestroy=b.undestroy,v.prototype._destroy=function(t,e){this.push(null),e(t)},v.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=l.from(t,e),e=""),n=!0),_(this,t,e,!1,n)},v.prototype.unshift=function(t){return _(this,t,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(t){return d||(d=n(11).StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};var S=8388608;function O(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=S?t=S:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function j(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(E,t):E(t))}function E(t){p("emit readable"),t.emit("readable"),x(t)}function k(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(R,t,e))}function R(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function T(t){p("readable nexttick read 0"),t.read(0)}function P(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),x(t),e.flowing&&!e.reading&&t.read(0)}function x(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function C(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0===(t-=s)){s===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=l.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,s),0===(t-=s)){s===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function A(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(I,e,t))}function I(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function M(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}v.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?A(this):j(this),null;if(0===(t=O(t,e))&&e.ended)return 0===e.length&&A(this),null;var r,i=e.needReadable;return p("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",i=!0),e.ended||e.reading?p("reading or ended",i=!1):i&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=O(n,e))),null===(r=t>0?C(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&A(this)),null!==r&&this.emit("data",r),r},v.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var a=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?c:v;function l(e,r){p("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),t.removeListener("close",g),t.removeListener("finish",m),t.removeListener("drain",f),t.removeListener("error",b),t.removeListener("unpipe",l),n.removeListener("end",c),n.removeListener("end",v),n.removeListener("data",y),h=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||f())}function c(){p("onend"),t.end()}o.endEmitted?i.nextTick(a):n.once("end",a),t.on("unpipe",l);var f=function(t){return function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&u(t,"data")&&(e.flowing=!0,x(t))}}(n);t.on("drain",f);var h=!1;var d=!1;function y(e){p("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==M(o.pipes,t))&&!h&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function b(e){p("onerror",e),v(),t.removeListener("error",b),0===u(t,"error")&&t.emit("error",e)}function g(){t.removeListener("finish",m),v()}function m(){p("onfinish"),t.removeListener("close",g),v()}function v(){p("unpipe"),n.unpipe(t)}return n.on("data",y),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?s(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",b),t.once("close",g),t.once("finish",m),t.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),t},v.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=M(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},v.prototype.on=function(t,e){var n=a.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&j(this):i.nextTick(T,this))}return n},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(P,t,e))}(this,t)),this},v.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",function(){if(p("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){(p("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&void 0!==i)&&((n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause())))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<g.length;o++)t.on(g[o],this.emit.bind(this,g[o]));return this._read=function(e){p("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=C}).call(this,n(1),n(3))},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=n(7).EventEmitter},function(t,e,n){"use strict";var r=n(5);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";t.exports=o;var r=n(2),i=n(4);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush(function(e,n){u(t,e,n)}):u(this,null,null)}function u(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(0),i.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){(function(e,r){var i,o,s,u,a;u=n(12),a=n(33),o=n(11).StringDecoder,t.exports=function(){var t,n,o,u,a,l,c;if(3===arguments.length){if(u=arguments[0],l=arguments[1],"function"!=typeof(t=arguments[2]))throw Error("Invalid callback argument: "+JSON.stringify(t));if("string"!=typeof u&&!e.isBuffer(arguments[0]))return t(Error("Invalid data argument: "+JSON.stringify(u)))}else if(2===arguments.length){if("string"==typeof arguments[0]||e.isBuffer(arguments[0])?u=arguments[0]:s(arguments[0])?l=arguments[0]:a="Invalid first argument: "+JSON.stringify(arguments[0]),"function"==typeof arguments[1]?t=arguments[1]:s(arguments[1])?l?a="Invalid arguments: got options twice as first and second arguments":l=arguments[1]:a="Invalid first argument: "+JSON.stringify(arguments[1]),a){if(t)return t(Error(a));throw Error(a)}}else 1===arguments.length&&("function"==typeof arguments[0]?t=arguments[0]:l=arguments[0]);return null==l&&(l={}),c=new i(l),null!=u&&r.nextTick(function(){return c.write(u),c.end()}),t&&(n=!1,o=l.objname?{}:[],c.on("readable",function(){var t,e;for(e=[];t=c.read();)l.objname?e.push(o[t[0]]=t[1]):e.push(o.push(t));return e}),c.on("error",function(e){return n=!0,t(e)}),c.on("end",function(){if(!n)return t(null,o)})),c},i=function(t){var e,n,r,i,s,a,l,c,f,h,p,d,y,b,g,m,v,_,w;for(_ in null==t&&(t={}),this.options={},t)w=t[_],this.options[_]=w;return this.options.objectMode=!0,u.Transform.call(this,this.options),null==(e=this.options).rowDelimiter&&(e.rowDelimiter=null),"string"==typeof this.options.rowDelimiter&&(this.options.rowDelimiter=[this.options.rowDelimiter]),null==(n=this.options).delimiter&&(n.delimiter=","),void 0===this.options.quote||this.options.quote||(this.options.quote=""),null==(h=this.options).quote&&(h.quote='"'),null==(p=this.options).escape&&(p.escape='"'),null==(d=this.options).columns&&(d.columns=null),null==(y=this.options).comment&&(y.comment=""),null==(b=this.options).objname&&(b.objname=!1),null==(g=this.options).trim&&(g.trim=!1),null==(m=this.options).ltrim&&(m.ltrim=!1),null==(v=this.options).rtrim&&(v.rtrim=!1),null==(r=this.options).auto_parse&&(r.auto_parse=!1),null==(i=this.options).auto_parse_date&&(i.auto_parse_date=!1),!0===this.options.auto_parse_date&&(this.options.auto_parse_date=function(t){var e;return e=Date.parse(t),isNaN(e)||(t=new Date(e)),t}),null==(s=this.options).relax&&(s.relax=!1),null==(a=this.options).relax_column_count&&(a.relax_column_count=!1),null==(l=this.options).skip_empty_lines&&(l.skip_empty_lines=!1),null==(c=this.options).max_limit_on_data_read&&(c.max_limit_on_data_read=128e3),null==(f=this.options).skip_lines_with_empty_values&&(f.skip_lines_with_empty_values=!1),this.lines=0,this.count=0,this.skipped_line_count=0,this.empty_line_count=0,this.is_int=/^(\-|\+)?([1-9]+[0-9]*)$/,this.is_float=function(t){return t-parseFloat(t)+1>=0},this._={decoder:new o,quoting:!1,commenting:!1,field:null,nextChar:null,closingQuote:0,line:[],chunks:[],rawBuf:"",buf:"",rowDelimiterLength:this.options.rowDelimiter?Math.max.apply(Math,this.options.rowDelimiter.map(function(t){return t.length})):void 0},this},a.inherits(i,u.Transform),t.exports.Parser=i,i.prototype._transform=function(t,n,r){var i;return t instanceof e&&(t=this._.decoder.write(t)),(i=this.__write(t,!1))?this.emit("error",i):r()},i.prototype._flush=function(t){var e;return(e=this.__write(this._.decoder.end(),!0))?this.emit("error",e):this._.quoting?void this.emit("error",new Error("Quoted field not terminated at line "+(this.lines+1))):this._.line.length>0&&(e=this.__push(this._.line))?t(e):t()},i.prototype.__push=function(t){var e,n,r,i,o,s,u,a,l;if(!this.options.skip_lines_with_empty_values||""!==t.join("").trim()){if(l=null,!0===this.options.columns)return this.options.columns=t,void"";if("function"==typeof this.options.columns)return n=(a=function(t,e){try{return[null,t.call(null,e)]}catch(t){return[t]}}(this.options.columns,t))[0],e=a[1],n||(this.options.columns=e,void"");if(!this._.line_length&&t.length>0&&(this._.line_length=this.options.columns?this.options.columns.length:t.length),1===t.length&&""===t[0])this.empty_line_count++;else if(t.length!==this._.line_length){if(!this.options.relax_column_count)return null!=this.options.columns?Error("Number of columns on line "+this.lines+" does not match header"):Error("Number of columns is inconsistent on line "+this.lines);this.count++,this.skipped_line_count++}else this.count++;if(null!=this.options.columns){for(u={},i=o=0,s=t.length;o<s;i=++o)r=t[i],!1!==this.options.columns[i]&&(u[this.options.columns[i]]=r);l=this.options.objname?[u[this.options.objname],u]:u}else l=t;if(!(this.count<this.options.from||this.count>this.options.to))return this.options.raw?(this.push({raw:this._.rawBuf,row:l}),this._.rawBuf=""):this.push(l),null}},i.prototype.__write=function(t,e){var n,r,i,o,s,u,a,l,c,f,h,p,d,y,b,g,m,v,_,w,S,O,j,E,k,R,T,P;for(b=function(t){return function(e){return"function"==typeof t.is_int?t.is_int(e):t.is_int.test(e)}}(this),y=function(t){return function(e){return"function"==typeof t.is_float?t.is_float(e):t.is_float.test(e)}}(this),i=function(t){return function(e){return t.options.auto_parse?"function"==typeof t.options.auto_parse?t.options.auto_parse(e):(b(e)?e=parseInt(e):y(e)?e=parseFloat(e):t.options.auto_parse_date&&(e=t.options.auto_parse_date(e)),e):e}}(this),m=this.options.trim||this.options.ltrim,T=this.options.trim||this.options.rtrim,t=this._.buf+t,g=t.length,a=0,0===this.lines&&65279===t.charCodeAt(0)&&a++;a<g&&(e||(k=t.substr(a,g-a),!(!this.options.rowDelimiter&&a+3>g||!this._.commenting&&g-a<this.options.comment.length&&this.options.comment.substr(0,g-a)===k||this.options.rowDelimiter&&g-a<this._.rowDelimiterLength&&this.options.rowDelimiter.some(function(t){return t.substr(0,g-a)===k})||this.options.rowDelimiter&&this._.quoting&&g-a<this.options.quote.length+this._.rowDelimiterLength&&this.options.rowDelimiter.some(function(t){return function(e){return(t.options.quote+e).substr(0,g-a)===k}}(this))||g-a<=this.options.delimiter.length&&this.options.delimiter.substr(0,g-a)===k||g-a<=this.options.escape.length&&this.options.escape.substr(0,g-a)===k)));)if(o=this._.nextChar?this._.nextChar:t.charAt(a),this._.nextChar=g>a+1?t.charAt(a+1):"",this.options.raw&&(this._.rawBuf+=o),null==this.options.rowDelimiter&&(v=a,R=null,this._.quoting||"\n"!==o&&"\r"!==o?!this._.quoting||o!==this.options.quote||"\n"!==(_=this._.nextChar)&&"\r"!==_||(R=this._.nextChar,v+=2,this.raw&&(rawBuf+=this._.nextChar)):(R=o,v+=1),R&&("\r"===R&&"\n"===t.charAt(v)&&(R+="\n"),this.options.rowDelimiter=[R],this._.rowDelimiterLength=R.length)),this._.commenting||o!==this.options.escape||(u=this.options.escape===this.options.quote,c=this._.nextChar===this.options.escape,h=this._.nextChar===this.options.quote,u&&null==this._.field&&!this._.quoting||!c&&!h)){if(!this._.commenting&&o===this.options.quote)if(this._.quoting){if(r=this.options.rowDelimiter&&this.options.rowDelimiter.some(function(e){return t.substr(a+1,e.length)===e}),n=t.substr(a+1,this.options.delimiter.length)===this.options.delimiter,f=this._.nextChar===this.options.comment,!this._.nextChar||r||n||f){this._.quoting=!1,this._.closingQuote=this.options.quote.length,a++,e&&a===g&&(this._.line.push(i(this._.field||"")),this._.field=null);continue}if(!this.options.relax)return Error("Invalid closing quote at line "+(this.lines+1)+"; found "+JSON.stringify(this._.nextChar)+" instead of delimiter "+JSON.stringify(this.options.delimiter));this._.quoting=!1,this._.field&&(this._.field=""+this.options.quote+this._.field)}else{if(!this._.field){this._.quoting=!0,a++;continue}if(null!=this._.field&&!this.options.relax)return Error("Invalid opening quote at line "+(this.lines+1))}if(((p=this.options.rowDelimiter&&this.options.rowDelimiter.some(function(e){return t.substr(a,e.length)===e}))||e&&a===g-1)&&this.lines++,P=!1,this._.commenting||this._.quoting||!this.options.comment||t.substr(a,this.options.comment.length)!==this.options.comment?this._.commenting&&p&&(P=!0,this._.commenting=!1):this._.commenting=!0,l=t.substr(a,this.options.delimiter.length)===this.options.delimiter,this._.commenting||this._.quoting||!l&&!p)this._.commenting||this._.quoting||" "!==o&&"\t"!==o?this._.commenting?a++:(null==this._.field&&(this._.field=""),this._.field+=o,a++):(null==this._.field&&(this._.field=""),m&&!this._.field||(this._.field+=o),a++);else{if(p&&(d=this.options.rowDelimiter.filter(function(e){return t.substr(a,e.length)===e})[0].length),p&&0===this._.line.length&&null==this._.field&&(P||this.options.skip_empty_lines)){a+=d,this._.nextChar=t.charAt(a);continue}if(T&&(this._.closingQuote||(this._.field=null!=(w=this._.field)?w.trimRight():void 0)),this._.line.push(i(this._.field||"")),this._.closingQuote=0,this._.field=null,l&&(a+=this.options.delimiter.length,this._.nextChar=t.charAt(a),e&&!this._.nextChar&&(p=!0,this._.line.push(""))),p){if(s=this.__push(this._.line))return s;this._.line=[],a+=d,this._.nextChar=t.charAt(a);continue}}if(!this._.commenting&&(null!=(S=this._.field)?S.length:void 0)>this.options.max_limit_on_data_read)return Error("Field exceeds max_limit_on_data_read setting ("+this.options.max_limit_on_data_read+") "+JSON.stringify(this.options.delimiter));if(!this._.commenting&&(null!=(O=this._.line)?O.length:void 0)>this.options.max_limit_on_data_read)return Error("Row delimiter not found in the file "+JSON.stringify(this.options.rowDelimiter))}else a++,o=this._.nextChar,this._.nextChar=t.charAt(a+1),null==this._.field&&(this._.field=""),this._.field+=o,this.options.raw&&(this._.rawBuf+=o),a++;if(e){if(null!=this._.field&&(T&&(this._.closingQuote||(this._.field=null!=(j=this._.field)?j.trimRight():void 0)),this._.line.push(i(this._.field||"")),this._.field=null),(null!=(E=this._.field)?E.length:void 0)>this.options.max_limit_on_data_read)return Error("Delimiter not found in the file "+JSON.stringify(this.options.delimiter));if(0===g&&this.lines++,this._.line.length>this.options.max_limit_on_data_read)return Error("Row delimiter not found in the file "+JSON.stringify(this.options.rowDelimiter))}return this._.buf=t.substr(a),null},s=function(t){var e;return e=t,"object"==typeof t&&null!==t&&!Array.isArray(t)&&function(){for(;null!==Object.getPrototypeOf(e=Object.getPrototypeOf(e)););return Object.getPrototypeOf(t===e)}()}}).call(this,n(9).Buffer,n(3))},function(t,e){!function(){var t=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^\(\s\/]*)\s*/;function e(){var e,n;return this===Function||this===Function.prototype.constructor?n="Function":this!==Function.prototype&&(n=(e=(""+this).match(t))&&e[1]),n||""}var n=!("name"in Function.prototype&&"name"in function(){}),r="function"==typeof Object.defineProperty&&function(){var t;try{Object.defineProperty(Function.prototype,"_xyz",{get:function(){return"blah"},configurable:!0}),t="blah"===Function.prototype._xyz,delete Function.prototype._xyz}catch(e){t=!1}return t}(),i="function"==typeof Object.prototype.__defineGetter__&&function(){var t;try{Function.prototype.__defineGetter__("_abc",function(){return"foo"}),t="foo"===Function.prototype._abc,delete Function.prototype._abc}catch(e){t=!1}return t}();Function.prototype._name=e,n&&(r?Object.defineProperty(Function.prototype,"name",{get:function(){var t=e.call(this);return this!==Function.prototype&&Object.defineProperty(this,"name",{value:t,configurable:!0}),t},configurable:!0}):i&&Function.prototype.__defineGetter__("name",function(){var t=e.call(this);return this!==Function.prototype&&this.__defineGetter__("name",function(){return t}),t}))}()},function(t,e,n){"use strict";e.byteLength=function(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=l(t),r=n[0],s=n[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),a=0,c=s>0?r-4:r,f=0;f<c;f+=4)e=i[t.charCodeAt(f)]<<18|i[t.charCodeAt(f+1)]<<12|i[t.charCodeAt(f+2)]<<6|i[t.charCodeAt(f+3)],u[a++]=e>>16&255,u[a++]=e>>8&255,u[a++]=255&e;2===s&&(e=i[t.charCodeAt(f)]<<2|i[t.charCodeAt(f+1)]>>4,u[a++]=255&e);1===s&&(e=i[t.charCodeAt(f)]<<10|i[t.charCodeAt(f+1)]<<4|i[t.charCodeAt(f+2)]>>2,u[a++]=e>>8&255,u[a++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,u=n-i;s<u;s+=16383)o.push(f(t,s,s+16383>u?u:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,a=s.length;u<a;++u)r[u]=s[u],i[s.charCodeAt(u)]=u;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function f(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(c(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,u=8*i-r-1,a=(1<<u)-1,l=a>>1,c=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-c)-1,p>>=-c,c+=u;c>0;o=256*o+t[e+f],f+=h,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+t[e+f],f+=h,c-=8);if(0===o)o=1-l;else{if(o===a)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=l}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,u,a,l=8*o-i-1,c=(1<<l)-1,f=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-s))<1&&(s--,a*=2),(e+=s+f>=1?h/a:h*Math.pow(2,1-f))*a>=2&&(s++,a/=2),s+f>=c?(u=0,s=c):s+f>=1?(u=(e*a-1)*Math.pow(2,i),s+=f):(u=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&u,p+=d,u/=256,i-=8);for(s=s<<i|u,l+=i;l>0;t[n+p]=255&s,p+=d,s/=256,l-=8);t[n+p-d]|=128*y}},function(t,e){},function(t,e,n){"use strict";var r=n(6).Buffer,i=n(24);function o(t,e,n){t.copy(e,n)}t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e=r.allocUnsafe(t>>>0),n=this.head,i=0;n;)o(n.data,e,i),i+=n.data.length,n=n.next;return e},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(26),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(1))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i=1,o={},s=!1,u=t.document,a=Object.getPrototypeOf&&Object.getPrototypeOf(t);a=a&&a.setTimeout?a:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){c(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&c(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),r=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){c(t.data)},r=function(e){t.port2.postMessage(e)}}():u&&"onreadystatechange"in u.createElement("script")?function(){var t=u.documentElement;r=function(e){var n=u.createElement("script");n.onreadystatechange=function(){c(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():r=function(t){setTimeout(c,0,t)},a.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var s={callback:t,args:e};return o[i]=s,r(i),i++},a.clearImmediate=l}function l(t){delete o[t]}function c(t){if(s)setTimeout(c,0,t);else{var e=o[t];if(e){s=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{l(t),s=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(1),n(3))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(1))},function(t,e,n){"use strict";t.exports=o;var r=n(17),i=n(4);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n(0),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(10)},function(t,e,n){t.exports=n(2)},function(t,e,n){t.exports=n(8).Transform},function(t,e,n){t.exports=n(8).PassThrough},function(t,e,n){(function(t,r){var i=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];n<o;a=r[++n])y(a)||!_(a)?s+=" "+a:s+=" "+u(a);return s},e.deprecate=function(n,i){if(m(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return n.apply(this,arguments)}};var o,s={};function u(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&e._extend(r,n),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=a),c(r,t,r.depth)}function a(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function l(t,e){return t}function c(t,n,r){if(t.customInspect&&n&&O(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return g(i)||(i=c(t,i,r)),i}var o=function(t,e){if(m(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(b(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(y(e))return t.stylize("null","null")}(t,n);if(o)return o;var s=Object.keys(n),u=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),S(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(O(n)){var a=n.name?": "+n.name:"";return t.stylize("[Function"+a+"]","special")}if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return f(n)}var l,_="",j=!1,E=["{","}"];(p(n)&&(j=!0,E=["[","]"]),O(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return v(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),S(n)&&(_=" "+f(n)),0!==s.length||j&&0!=n.length?r<0?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=j?function(t,e,n,r,i){for(var o=[],s=0,u=e.length;s<u;++s)R(e,String(s))?o.push(h(t,e,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}(t,n,r,u,s):s.map(function(e){return h(t,n,r,u,e,j)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(l,_,E)):E[0]+_+E[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,o){var s,u,a;if((a=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(u=t.stylize("[Setter]","special")),R(r,i)||(s="["+i+"]"),u||(t.seen.indexOf(a.value)<0?(u=y(n)?c(t,a.value,null):c(t,a.value,n-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),m(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function y(t){return null===t}function b(t){return"number"==typeof t}function g(t){return"string"==typeof t}function m(t){return void 0===t}function v(t){return _(t)&&"[object RegExp]"===j(t)}function _(t){return"object"==typeof t&&null!==t}function w(t){return _(t)&&"[object Date]"===j(t)}function S(t){return _(t)&&("[object Error]"===j(t)||t instanceof Error)}function O(t){return"function"==typeof t}function j(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(m(o)&&(o=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=d,e.isNull=y,e.isNullOrUndefined=function(t){return null==t},e.isNumber=b,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=m,e.isRegExp=v,e.isObject=_,e.isDate=w,e.isError=S,e.isFunction=O,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(34);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(0),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(1),n(3))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,n){"use strict";n.r(e);n(19);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t){return t=window.parseInt(t,10),isNaN(t)?null:t}function o(t){var e=new Date(t);return isNaN(e.getTime())?null:e}String.prototype.startsWith||(String.prototype.startsWith=function(t){return this.substring(0,t.length)===t},String.prototype.endsWith=function(t){return this.substring(this.length-t.length)===t});var s={clone:function(t){return t.slice(0)},findFirstIndex:function(t,e){return t.indexOf(e)},removeFirst:function(t,e){var n=this.findFirstIndex(t,e);return n>=0&&(t.splice(n,1),!0)}};function u(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(t){var e=document.createElement("div");if(e.innerHTML=t,1!=e.children.length)throw new Error("Failed to create DOM element from HTML: "+function(t,e,n){return void 0===n&&(n="..."),t.length<=e?t:t.substring(0,e)+n}(t,20));return e.firstElementChild}function l(t,e){return t=t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,void 0===e?t:e[t]}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handlers=[],this._mute=0}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"bind",value:function(t,e){if(null==t)throw new Error("Argument is null: handler");this.handlers.push({handler:t,context:e})}},{key:"unbind",value:function(t,e){if(null==t)throw new Error("Argument is null: handler");var n=this.handlers.length;if(this.handlers=this.handlers.filter(function(n){return!(n.handler===t&&(void 0===e||n.context===e))}),this.handlers.length==n)throw new Error("Handler to unbind was not found")}},{key:"trigger",value:function(t){if(!(this._mute>0)){void 0===t&&(t={});for(var e=s.clone(this.handlers),n=0,r=e.length;n<r;n++){var i=e[n];i.handler.call(i.context,t)}}}},{key:"mute",value:function(t){void 0===t&&(t=1),this._mute+=t}},{key:"getLength",value:function(){return this.handlers.length}}]),t}(),f=h;function h(){this.visible=!0,this.uid=this.constructor.name+"-"+h.counter++,this._parent=null,this.children=[],this.onDestroy=new c,h.views[this.uid]=this}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t,e,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}h.counter=1,h.views={},h.prototype.addChild=function(t){if(t._parent)throw new Error("changing parent currently not supported");return this.children.push(t),t._parent=this,t},h.prototype.install=function(t){var e=a(this.getHtml());t.append(e),this.onInstalled($(e),t)},h.prototype.onInstalled=function(t,e){if(t)this._$element=t;else{if(!(t=$("#"+this.uid,e)).length)return;this._$element=t}this.visible||(this._$element[0].style.display="none");for(var n=s.clone(this.children),r=0,i=n.length;r<i;r++)n[r].onInstalled(void 0,this._$element)},h.prototype.$element=function(){return this._$element||$([])},h.prototype.getHtml=function(){throw new Error("Not implemented in "+this.constructor.name)},h.prototype.redraw=function(){var t=this.$element();if(t.length){var e=a(this.getHtml());t.replaceWith(e),this.onInstalled($(e))}},h.prototype.destroy=function(){for(var t=0,e=this.children.length;t<e;t++)this.children[t].destroy();this.children.length=0,this.onDestroy.trigger(),this._parent=null,this.onDestroy=null,delete h.views[this.uid]},h._removeChild=function(t,e){if(null==t)throw new Error("Argument is null: parent");if(null==e)throw new Error("Argument is null: child");var n=t.children.indexOf(e);if(n<0)throw new Error("Could not find child view to remove","parent",t.uid,"child",e.uid);t.children.splice(n,1)},h.prototype.setVisible=function(t){this.visible=t,this._$element&&(this.visible?this._$element[0].style.removeProperty("display"):this._$element[0].style.display="none")},h.prototype.toggleVisible=function(){return this.setVisible(!this.visible)};var v=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=y(this,g(e).call(this)))._tabs=[],t._activeId=null,t.onActiveIdChanged=new c,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,f),function(t,e,n){e&&d(t.prototype,e),n&&d(t,n)}(e,[{key:"addTab",value:function(t,e){if(null==t)throw new Error("Argument null: id");this._tabs.push({id:t,title:e})}},{key:"activeId",value:function(t){return void 0===t?this._activeId:this._setActiveId(t,!1)}},{key:"_setActiveId",value:function(t,e){return this._activeId!=t&&(null!=this._activeId&&this.$element().find("#"+this.uid+"_tab-"+this._activeId).removeClass("tabcontrol_tab__active"),this._activeId=t,this.$element().find("#"+this.uid+"_tab-"+this._activeId).addClass("tabcontrol_tab__active"),e&&this.onActiveIdChanged.trigger(),!0)}},{key:"getHtml",value:function(){var t=this;return'\n\t\t\t<div id="'.concat(this.uid,'" class="tabcontrol">\n\t\t\t\t').concat(this._tabs.map(function(e){return'<span\n\t\t\t\t\tclass="tabcontrol_tab '.concat(e.id==t._activeId?"tabcontrol_tab__active":"",'"\n\t\t\t\t\tid="').concat(t.uid+"_tab-"+e.id,'">\n\t\t\t\t\t').concat(u(e.title),"\n\t\t\t\t</span>")}).join(""),"\n\t\t\t</div>\n\t\t")}},{key:"onInstalled",value:function(){b(g(e.prototype),"onInstalled",this).apply(this,arguments);var t=this;t.$element().children().click(function(){var e=t.uid+"_tab-";if(this.id&&this.id.startsWith(e)){var n=this.id.substring(e.length);t._setActiveId(n,!0)}})}}]),e}();function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e,n){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,e){return(j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var k=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=E(E(n=function(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?E(t):e}(this,O(e).call(this))));return r._loadController=t,t.onOperationStart.bind(function(){r._clearReport()}),t.onOperationEnd.bind(function(t){t&&r._reportError(t)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&j(t,e)}(e,f),function(t,e,n){e&&w(t.prototype,e),n&&w(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="dataview">\n\t\t\t\t<div id="').concat(this.uid+"_messages",'"></div>\n\t\t\t\tИспользуются следующие данные:\n\t\t\t\t<ul class="dataview_sources">\n\t\t\t\t\t<li>').concat(R(this._loadController.participantsRegistryUrl),"</li>\n\t\t\t\t\t<li>").concat(R(this._loadController.ownersRegistryUrl),"</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t").concat(R(this._loadController.apartmentsWithoutSectionUrl),'\n\t\t\t\t\t\t<label>Загрузить свой файл: <input type="file" id="').concat(this.uid+"_apartmentsWithoutSection",'"></label>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t').concat(R(this._loadController.incorrectApartmentsUrl),'\n\t\t\t\t\t\t<label>Загрузить свой файл: <input type="file" id="').concat(this.uid+"_incorrectApartments",'"></label>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t').concat(R(this._loadController.oldApartmentNumbersUrl),'\n\t\t\t\t\t\t<label>Загрузить свой файл: <input type="file" id="').concat(this.uid+"_oldApartmentNumbers",'"></label>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t').concat(R(this._loadController.juridicalPersonsUrl),'\n\t\t\t\t\t\t<label>Загрузить свой файл: <input type="file" id="').concat(this.uid+"_juridicalPersons",'"></label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<button id="').concat(this.uid+"_refresh",'">Обновить</button>\n\t\t\t</div>\n\t\t')}},{key:"onInstalled",value:function(){S(O(e.prototype),"onInstalled",this).apply(this,arguments);var t=this,n=t.$element();n.find("#"+this.uid+"_apartmentsWithoutSection").change(function(e){var n=e.target.files[0];n?t._loadController.loadApartmentsWithoutSection(n):t._loadController.loadDefaultApartmentsWithoutSection()}),n.find("#"+this.uid+"_incorrectApartments").change(function(e){var n=e.target.files[0];n?t._loadController.loadIncorrectApartments(n):t._loadController.loadDefaultIncorrectApartments()}),n.find("#"+this._uid+"_oldApartmentNumbers").change(function(e){var n=e.target.files[0];n?t._loadController.loadOldApartmentNumbers(n):t._loadController.loadDefaultOldApartmentNumbers()}),n.find("#"+this._uid+"_juridicalPersons").change(function(e){var n=e.target.files[0];n?t._loadController.loadJuridicalPersons(n):t._loadController.loadDefaultJuridicalPersons()}),n.find("#"+this.uid+"_refresh").click(function(){t._refresh()})}},{key:"_refresh",value:function(){this._loadController.updateModel()}},{key:"_clearReport",value:function(){this.$element().find("#"+this.uid+"_messages").html("")}},{key:"_reportError",value:function(t){this.$element().find("#"+this.uid+"_messages").text(t.message)}}]),e}();function R(t){var e=t.substring(t.lastIndexOf("/")+1);return'<a href="'.concat(t,'" target="_blank">').concat(u(e),"</a>")}var T="???",P="✕";function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e){return!e||"object"!==x(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function D(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var L=function t(){D(this,t),this.id=null},B=function(t){function e(t,n,r,i){var o;return D(this,e),(o=A(this,I(e).call(this))).number=t,o.registryNumber=n,o.date=r,o.owner=null,o.source=i,o}return M(e,L),e}();B.prototype.type="ЕГРП";var U=function(t){function e(t,n){var r;return D(this,e),(r=A(this,I(e).call(this))).number=t,r.owner=n,r}return M(e,L),e}();U.prototype.type="Реестр собственников долей";var q=function t(e){D(this,t),this.id=null,this.record=e},F=function(t){function e(t,n,r,i){var o;return D(this,e),(o=A(this,I(e).call(this,t))).number=n,o.building=r,o.area=i,o}return M(e,q),e}(),W=function(t){function e(t,n,r,i,o,s,u,a){var l;return D(this,e),(l=A(this,I(e).call(this,t))).type=n,l.number=r,l.originalNumber=null,l.building=i,l.floor=o,l.landingNumber=s,l.section=u,l.area=a,l.duplicate=!1,l}return M(e,q),function(t,e,n){e&&C(t.prototype,e),n&&C(t,n)}(e,[{key:"setNumber",value:function(t){if(null!=this.originalNumber)throw new Error("Исходный номер квартиры уже задан: "+this.originalNumber);this.originalNumber=this.number,this.number=t}}]),e}(),Y=function(t){function e(t,n,r,i,o,s){var u;return D(this,e),(u=A(this,I(e).call(this,t))).type=n,u.number=r,u.building=i,u.section=o,u.area=s,u}return M(e,q),e}();function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function G(t,e){return!e||"object"!==H(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function J(t,e,n){return(J="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=V(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var X=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),G(this,V(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(e,f),function(t,e,n){e&&z(t.prototype,e),n&&z(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="objectpopup">\n\t\t\t</div>\n\t\t')}},{key:"onInstalled",value:function(){J(V(e.prototype),"onInstalled",this).apply(this,arguments)}},{key:"setObject",value:function(t){var e=[];!function(t,e){e.push(u(t.type)),e.push(" №"),null!=t.originalNumber?(e.push("<span class='objectpopup_withOriginalNumber'>"),e.push(u(t.number.toString())),e.push("</span>"),e.push(" ("),e.push(u(t.originalNumber.toString())),e.push(")")):e.push(u(t.number.toString()));e.push("<br>"),e.push("Корпус "),e.push(u(t.building.toString())),e.push(", секция "),e.push(null==t.section?T:u(t.section.toString())),e.push(", этаж "),e.push(null==t.floor?T:u(t.floor.toString())),e.push("<br>"),e.push("Номер на площадке "),e.push(null==t.landingNumber?T:u(t.landingNumber.toString())),e.push("<br>"),e.push("Площадь "),e.push(t.area.toString()),e.push(" кв.м."),e.push("<br>"),e.push(t.record.type),e.push(t.record instanceof U?",<br>":", "),e.push("запись №"),e.push(u(t.record.number.toString())),e.push("<br>"),e.push("Дата регистрации "),e.push(null==t.record.date?T:u(function(t){var e=("0"+t.getDate()).slice(-2),n=("0"+(t.getMonth()+1)).slice(-2),r=t.getFullYear();return"".concat(e,".").concat(n,".").concat(r)}(t.record.date)))}(t,e),this.$element().html(e.join(""))}},{key:"show",value:function(t){var e=this.$element(),n=t.pageX,r=t.pageY;e.css({left:n,top:r}).show();var i=e.outerWidth();n+i>window.scrollX+window.innerWidth&&n-i>window.scrollX&&e.css("left",n-i);var o=e.outerHeight();r+o>window.scrollY+window.innerHeight&&r-o>window.scrollY&&e.css("top",r-o),(void 0).popupManager.registerPopup(e[0])}},{key:"hide",value:function(){this.$element().hide()}}]),e}();function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tt(t,e,n){return(tt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=et(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function et(t){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nt(t,e){return(nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var it=function(t){function e(t,n,r){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=rt(rt(i=function(t,e){return!e||"object"!==Z(e)&&"function"!=typeof e?rt(t):e}(this,et(e).call(this))));return o.objectPopup=o.addChild(new X),o._model=t,o._searchModel=n,o._recordSelectionModel=r,o._searchModel.onChanged.bind(function(){o._showSearchResults()}),o._recordSelectionModel.onChanged.bind(function(){o._showSelectedRecord()}),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nt(t,e)}(e,f),function(t,e,n){e&&K(t.prototype,e),n&&K(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="grid">\n\t\t\t\t').concat(this.objectPopup.getHtml(),'\n\t\t\t\t<div class="grid_content"></div>\n\t\t\t</div>\n\t\t')}},{key:"onInstalled",value:function(){tt(et(e.prototype),"onInstalled",this).apply(this,arguments);var t=this;t.$element().click(function(e){var n=$(e.target).closest(".grid_object");if(n.length){var r=n[0].id,i=t.uid+"_obj-";r&&r.startsWith(i)&&(r=r.substring(i.length),t._selectObject(r,e))}})}},{key:"redraw",value:function(){this.objectPopup.hide();var t=[];!function(t,e,n,r){e.sort(function(t,e){return At.isSupportedObject(t)-At.isSupportedObject(e)||t.building-e.building||(null==t.section)-(null==e.section)||t.section-e.section||(null==t.floor)-(null==e.floor)||e.floor-t.floor||t.number-e.number||(null!=t.record.date)-(null!=e.record.date)||t.record.date-e.record.date});for(var i=null,o=null,s=null,u=null,a=0,l=e.length;a<l;a++){var c=e[a];if(At.isSupportedObject(c)){var f=c.building,h=c.section;f==i&&h==o||(null==s&&null==u||(r.push("</div>"),s=null,u=null),null!=i&&(ot(i,o,r),r.push("</div>")),r.push("<div class='grid_section'>"),i=f,o=h);var p=c.floor,d=c.constructor.name;p==s&&d==u||(null==s&&null==u||r.push("</div>"),r.push("<div class='grid_floor grid_floor__".concat(d,"'>")),st(c,r),s=p,u=d),ut(t,c,n,r)}}r.push("</div>"),ot(i,o,r),r.push("</div>")}(this.uid,this._model.objects,this._searchModel.getObjectIds(),t),this.$element().children(".grid_content").html(t.join(""))}},{key:"_showSearchResults",value:function(){var t=this.$element();if(t.length){t.find(".grid_object__search").removeClass("grid_object__search");for(var e=this._searchModel.getObjectIds(),n=0,r=e.length;n<r;n++){var i=e[n];t.find("#"+this.uid+"_obj-"+i).addClass("grid_object__search")}}}},{key:"_showSelectedRecord",value:function(){var t=this.$element();if(t.length){t.find(".grid_object__selectedRecord").removeClass("grid_object__selectedRecord");var e=this._recordSelectionModel.getRecord();if(e)for(var n=0,r=e.objects.length;n<r;n++){var i=e.objects[n];t.find("#"+this.uid+"_obj-"+i.id).addClass("grid_object__selectedRecord")}}}},{key:"_selectObject",value:function(t,e){var n=this._model.getObjectById(t);n&&(this._recordSelectionModel.setRecord(n.record),this.objectPopup.setObject(n),this.objectPopup.show(e))}}]),e}();function ot(t,e,n){n.push("<div class='grid_sectionInfo'>Корпус ".concat(t," Секция ").concat(null==e?T:e,"</div>"))}function st(t,e){t instanceof W?(e.push("<span class='grid_floorNumber'>"),e.push(u(t.floor.toString())),e.push("</span>")):t instanceof Y&&e.push("<span class='grid_floorNumber' title='Нежилые помещения'>".concat(P,"</span>"))}function ut(t,e,n,r){var i=["grid_object"];e.duplicate&&i.push("grid_object__duplicate"),null!=e.originalNumber&&i.push("grid_object__withOriginalNumber"),n.indexOf(e.id)>=0&&i.push("grid_object__search"),i=i.join(" "),r.push('<div class="'.concat(i,'" id="').concat(t+"_obj-"+e.id,'">')),null!=e.number&&r.push(u(e.number.toString())),r.push("</div>")}function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ct(t,e){return!e||"object"!==at(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ft(t,e,n){return(ft="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ht(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ht(t){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pt(t,e){return(pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dt=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ct(this,ht(e).call(this)))._model=t,r._searchModel=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pt(t,e)}(e,f),function(t,e,n){e&&lt(t.prototype,e),n&&lt(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="searchview">\n\t\t\t\t<div class="caption">Поиск</div>\n\t\t\t\t<label>Тип записи: <select id="').concat(this.uid+"_recordType",'">\n\t\t\t\t\t<option>\n\t\t\t\t\t<option value="ЕГРП">ЕГРП</option>\n\t\t\t\t\t<option value="Реестр собственников долей">Реестр собственников долей</option>\n\t\t\t\t</select></label>\n\t\t\t\t<label>Номер записи: <input id="').concat(this.uid+"_recordNumber",'" size="5"></label>\n\t\t\t\t<label>Текст в записи:<br/><input id="').concat(this.uid+"_recordText",'" size="40"></label>\n\t\t\t\tДата регистрации\n\t\t\t\t\t<label>с <input type="date" id="').concat(this.uid+"_dateFrom",'"></label>\n\t\t\t\t\t<label>по <input type="date" id="').concat(this.uid+"_dateTo",'"></label>\n\t\t\t\t<label>Лицо: <select id="').concat(this.uid+"_person",'">\n\t\t\t\t\t<option>\n\t\t\t\t\t<option value="physical">Физическое</option>\n\t\t\t\t\t<option value="juridical">Юридическое</option>\n\t\t\t\t</select></label>\n\t\t\t\t<label>Количество объектов в записи ≥ <input id="').concat(this.uid+"_objectsCountGe",'" size="5"></label>\n\t\t\t\t<label>Количество квартир в записи ≥ <input id="').concat(this.uid+"_apartmentsCountGe",'" size="5"></label>\n\t\t\t\t<label>Номер объекта: <input id="').concat(this.uid+"_number",'" size="5"></label>\n\t\t\t\t<button id="').concat(this.uid+"_apply",'">Применить</button>\n\t\t\t\t<div class="searchview_searchStats">\n\t\t\t\t\tНайдено <span id="').concat(this.uid+"_foundObjectsCount",'">0 объектов</span>\n\t\t\t\t\t(из них <span id="').concat(this.uid+"_foundApartmentsCount",'">0 квартир</span>)\n\t\t\t\t\tв <span id="').concat(this.uid+"_foundRecordsCount",'">0 записях</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t')}},{key:"onInstalled",value:function(){ft(ht(e.prototype),"onInstalled",this).apply(this,arguments);var t=this,n=t.$element();n.find("#"+t.uid+"_apply").click(function(){t.apply()}),n.find(":input").bind("change input",function(){t.apply()})}},{key:"apply",value:function(){var t=[],e={},n=this._getFilters();if(n)for(var r=this._model.objects,i=0,o=r.length;i<o;i++){var s=r[i];if(At.isSupportedObject(s)&&((!n.recordType||s.record.type==n.recordType)&&(null==n.recordNumber||s.record.number==n.recordNumber)&&(!n.recordText||null!=s.record.source&&s.record.source.toLowerCase().indexOf(n.recordText.toLowerCase())>=0||null!=s.record.owner&&s.record.owner.toLowerCase().indexOf(n.recordText.toLowerCase())>=0)&&(!n.dateFrom||s.record.date&&s.record.date>=n.dateFrom)&&(!n.dateTo||s.record.date&&s.record.date<=n.dateTo))){if(n.person){if("juridical"==n.person&&s.record.owner)continue;if("physical"==n.person&&!s.record.owner)continue}null!=n.number&&s.number!=n.number&&s.originalNumber!=n.number||null!=n.objectsCountGe&&s.record.objects.length<n.objectsCountGe||null!=n.apartmentsCountGe&&s.record.objects.filter(function(t){return t instanceof W}).length<n.apartmentsCountGe||(t.push(s.id),e[s.record.id]=!0)}}this._showSearchStats(t,e),this._searchModel.setObjectIds(t)}},{key:"_getFilters",value:function(){var t=this.$element(),e=t.find("#"+this.uid+"_recordType").removeClass("error"),n=t.find("#"+this.uid+"_recordNumber").removeClass("error"),r=t.find("#"+this.uid+"_recordText").removeClass("error"),s=t.find("#"+this.uid+"_dateFrom").removeClass("error"),u=t.find("#"+this.uid+"_dateTo").removeClass("error"),a=t.find("#"+this.uid+"_person").removeClass("error"),l=t.find("#"+this.uid+"_number").removeClass("error"),c=t.find("#"+this.uid+"_objectsCountGe").removeClass("error"),f=t.find("#"+this.uid+"_apartmentsCountGe").removeClass("error"),h=e.val(),p=n.val();p?null==(p=i(p))&&n.addClass("error"):p=null;var d=r.val(),y=s.val();y?null==(y=o(y))&&s.addClass("error"):y=null;var b=u.val();b?null==(b=o(b))&&u.addClass("error"):b=null;var g=a.val(),m=l.val();m?null==(m=i(m))&&l.addClass("error"):m=null;var v=c.val();v?null==(v=i(v))&&c.addClass("error"):v=null;var _=f.val();return _?null==(_=i(_))&&f.addClass("error"):_=null,h||null!=p||d||y||b||g||null!=m||null!=v||null!=_?{recordType:h,recordNumber:p,recordText:d,dateFrom:y,dateTo:b,person:g,number:m,objectsCountGe:v,apartmentsCountGe:_}:null}},{key:"_showSearchStats",value:function(t,e){for(var n=t.length,r=0,i=0;i<t.length;i++){this._model.getObjectById(t[i])instanceof W&&r++}var o=0;for(var s in e)e.hasOwnProperty(s)&&o++;var u=this.$element(),a=u.find("#"+this.uid+"_foundObjectsCount"),c=u.find("#"+this.uid+"_foundApartmentsCount"),f=u.find("#"+this.uid+"_foundRecordsCount");a.text(n+" "+l(n,["объект","объекта","объектов"])),c.text(r+" "+l(r,["квартира","квартиры","квартир"])),f.text(o+" "+l(o,["записи","записях","записях"]))}}]),e}();function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._ids=[],this.onChanged=new c}return function(t,e,n){e&&yt(t.prototype,e),n&&yt(t,n)}(t,[{key:"setObjectIds",value:function(t){0==this._ids.length&&0==t.length||(this._ids=t,this.onChanged.trigger())}},{key:"getObjectIds",value:function(){return this._ids}}]),t}();function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._record=null,this.onChanged=new c}return function(t,e,n){e&&gt(t.prototype,e),n&&gt(t,n)}(t,[{key:"setRecord",value:function(t){t!=this._record&&(this._record=t,this.onChanged.trigger())}},{key:"clear",value:function(){this.setRecord(null)}},{key:"getRecord",value:function(){return this._record}}]),t}();function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wt(t,e,n){return(wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ot(t,e){return(Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Et=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=jt(jt(n=function(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?jt(t):e}(this,St(e).call(this))));return r._recordSelectionModel=t,r._recordSelectionModel.onChanged.bind(function(){var t=r._recordSelectionModel.getRecord();r._redraw(t)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ot(t,e)}(e,f),function(t,e,n){e&&_t(t.prototype,e),n&&_t(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="recordinfo">\n\t\t\t</div>\n\t\t')}},{key:"onInstalled",value:function(){wt(St(e.prototype),"onInstalled",this).apply(this,arguments);var t=this;t.$element().click(function(e){$(e.target).closest(".recordinfo_close").length&&t._recordSelectionModel.clear()})}},{key:"_redraw",value:function(t){var e=[];t&&function(t,e){if(e.push("<div class='caption'>Информация о записи <span class='recordinfo_close'>".concat(P,"</span></div>")),e.push(u(t.type)),e.push(", №"),e.push(u(t.number.toString())),e.push("<br/>"),t instanceof B)e.push("<div class='recordinfo_source'>"),e.push(u(t.source)),e.push("</div>");else{if(!(t instanceof U))throw new Error("Неизвестный тип записи: "+t.constructor.name);e.push(u(t.owner))}}(t,e),this.$element().html(e.join(""))}}]),e}();function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ct=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=xt(xt(n=function(t,e){return!e||"object"!==kt(e)&&"function"!=typeof e?xt(t):e}(this,Tt(e).call(this)))),i=new bt,o=new mt;return r.searchView=r.addChild(new dt(t,i)),r.recordInfo=r.addChild(new Et(o)),r.grid=r.addChild(new it(t,i,o)),t.onChanged.bind(function(){o.clear(),i.onChanged.mute(),r.searchView.apply(),i.onChanged.mute(-1),r.grid.redraw()}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(e,f),function(t,e,n){e&&Rt(t.prototype,e),n&&Rt(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="gridview">\n\t\t\t\t<div class="gridview_sidebar">\n\t\t\t\t\t').concat(this.searchView.getHtml(),"\n\t\t\t\t\t").concat(this.recordInfo.getHtml(),"\n\t\t\t\t</div>\n\t\t\t\t").concat(this.grid.getHtml(),"\n\t\t\t</div>\n\t\t")}}]),e}();Ct.isSupportedObject=function(t){return t instanceof W||t instanceof Y};var At=Ct;function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Mt="\ncreate table Record (\n\tid int not null primary key,\n\ttype text not null,\n\tnumber int not null,\n\tregistryNumber text,\n\t[date] date,\n\towner text,\n\tsource text\n);\n\ncreate table ParkingPlace (\n\tid int not null primary key,\n\trecordId int not null references Record(id),\n\tnumber int not null,\n\tbuilding int not null,\n\tarea number not null\n);\n\ncreate table Apartment (\n\tid int not null primary key,\n\trecordId int not null references Record(id),\n\ttype text not null,\n\tnumber int not null,\n\toriginalNumber int,\n\tbuilding int not null,\n\tfloor int not null,\n\tlandingNumber int,\n\tsection int null,\n\tarea number not null,\n\tduplicate bool not null\n);\n\n/* Non-Residential Premise */\ncreate table NRPremise (\n\tid int not null primary key,\n\trecordId int not null references Record(id),\n\ttype text not null,\n\tnumber int null,\n\tbuilding int not null,\n\tsection int null,\n\tarea number not null\n);\n".trim(),Nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),alasql.options.casesensitive="false",alasql.options.modifier="MATRIX",this.db=new alasql.Database,Lt(this.db)}return function(t,e,n){e&&It(t.prototype,e),n&&It(t,n)}(t,[{key:"init",value:function(t){var e=new alasql.Database;Lt(e),function(t,e){for(var n=0,r=e.objects.length;n<r;n++){var i=e.objects[n];i.recordId=i.record.id}var o=e.records,s=e.objects.filter(function(t){return t instanceof F}),u=e.objects.filter(function(t){return t instanceof W}),a=e.objects.filter(function(t){return t instanceof Y});t.exec("\n\t\tINSERT INTO Record(id, type, number, registryNumber, [date], owner, source)\n\t\tSELECT id, type, number, registryNumber, [date], owner, source\n\t\tFROM ?;\n\n\t\tINSERT INTO ParkingPlace(id, recordId, number, building, area)\n\t\tSELECT id, recordId, number, building, area\n\t\tFROM ?;\n\n\t\tINSERT INTO Apartment(id, recordId, type, number, originalNumber, building, floor, landingNumber, section, area, duplicate)\n\t\tSELECT id, recordId, type, number, originalNumber, building, floor, landingNumber, section, area, duplicate\n\t\tFROM ?;\n\n\t\tINSERT INTO NRPremise(id, recordId, type, number, building, section, area)\n\t\tSELECT id, recordId, type, number, building, section, area\n\t\tFROM ?;\n\t",[o,s,u,a])}(e,t),this.db=e}},{key:"query",value:function(t){var e=this.db.exec(t);return e.length>0&&e[0].length>0&&$.isArray(e[0][0])?e:[e]}},{key:"swap",value:function(t){var e=this.db;this.db=t.db,t.db=e}}]),t}();Nt.Schema=Mt;var Dt=Nt;function Lt(t){t.exec(Mt)}function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qt(t,e){return!e||"object"!==Bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ft(t,e,n){return(Ft="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$t(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function $t(t){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wt(t,e){return(Wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yt="\nSELECT r.source\nFROM Apartment a\nJOIN Record r ON r.id = a.recordId\nWHERE a.number = 1\n".trim(),Ht=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qt(this,$t(e).call(this)))._sqlModel=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wt(t,e)}(e,f),function(t,e,n){e&&Ut(t.prototype,e),n&&Ut(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="sqlview">\n\t\t\t\t<div class="sqlview_wrapper">\n\t\t\t\t\t<div class="sqlview_controls">\n\t\t\t\t\t\t<textarea cols="40" rows="20"></textarea><br/>\n\t\t\t\t\t\t<button id="').concat(this.uid+"_example",'" class="sqlview_btnExample">Пример</button>\n\t\t\t\t\t\t<button id="').concat(this.uid+"_query",'">Выполнить</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="sqlview_schema">\n\t\t\t\t\t\t<div class="caption">Схема:</div>\n\t\t\t\t\t\t<pre>').concat(u(Dt.Schema),'</pre>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="').concat(this.uid+"_messages",'" class="sqlview_messages"></div>\n\t\t\t\t<div id="').concat(this.uid+"_results",'"></div>\n\t\t\t</div>\n\t\t')}},{key:"onInstalled",value:function(){Ft($t(e.prototype),"onInstalled",this).apply(this,arguments);var t=this;this.$element().find("#"+this.uid+"_query").click(function(){var e=t.$element().find("textarea").val();t._query(e)}),this.$element().find("#"+this.uid+"_example").click(function(){t.$element().find("textarea").val(Yt),t._query(Yt)})}},{key:"_query",value:function(t){if(this._clearReport(),this._clearResults(),0!=t.trim().length){try{var e=this._sqlModel.query(t)}catch(t){return void this._reportError(t)}this._showResults(e)}else this._reportFailure("Введите запрос")}},{key:"_clearReport",value:function(){this.$element().find("#"+this.uid+"_messages").empty()}},{key:"_reportFailure",value:function(t){this.$element().find("#"+this.uid+"_messages").text(t)}},{key:"_reportError",value:function(t){this._reportFailure(t.message)}},{key:"_clearResults",value:function(){this.$element().find("#"+this.uid+"_results").empty()}},{key:"_showResults",value:function(t){for(var e=this.$element().find("#"+this.uid+"_results"),n=[],r=0,i=t.length;r<i;r++)zt(t[r],n);e.html(n.join(""))}}]),e}();function zt(t,e){if(0!=t.length){e.push("<table>");for(var n=0,r=t.length;n<r;n++){var i=t[n];e.push("<tr>");for(var o=0,s=i.length;o<s;o++){e.push("<td>"),null!=i[o]&&e.push(u(i[o].toString()))}}e.push("</table>")}else e.push("<table><tr><td><em>Нет результатов</em></td></tr></div>")}function Gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;e._activePopup=null,$(document.body).mousedown(function(t){e._activePopup&&0==$(t.target).closest(e._activePopup).length&&e._hide()})}return function(t,e,n){e&&Gt(t.prototype,e),n&&Gt(t,n)}(t,[{key:"registerPopup",value:function(t){if(!t)throw new Error("Argument is null: el");t!=this._activePopup&&(this._hide(),this._activePopup=t)}},{key:"_hide",value:function(){this._activePopup&&($(this._activePopup).hide(),this._activePopup=null)}}]),t}();function Vt(t){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zt(t,e){return(Zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var te=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==Vt(e)&&"function"!=typeof e?Kt(t):e}(this,Xt(e).call(this)),e.instance=Kt(Kt(r));var i=Kt(Kt(r));return i._loadController=n,i.popupManager=new Jt,i.tabControl=i.addChild(new v),i.tabControl.addTab(ee.Data,"Данные"),i.tabControl.addTab(ee.Grid,"Шахматка"),i.tabControl.addTab(ee.Sql,"SQL"),i.dataView=i.addChild(new k(n)),i.gridView=i.addChild(new At(t)),i.sqlView=i.addChild(new Ht(t.sqlModel)),i._onTabChanged(),i.tabControl.onActiveIdChanged.bind(function(){i._onTabChanged()}),t.onChanged.bind(function(){i.getActiveTab()==ee.Data&&i.setActiveTab(ee.Grid)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zt(t,e)}(e,f),function(t,e,n){e&&Qt(t.prototype,e),n&&Qt(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="mainview">\n\t\t\t\t').concat(this.tabControl.getHtml(),"\n\t\t\t\t").concat(this.dataView.getHtml(),"\n\t\t\t\t").concat(this.gridView.getHtml(),"\n\t\t\t\t").concat(this.sqlView.getHtml(),"\n\t\t\t</div>\n\t\t")}},{key:"getActiveTab",value:function(){return this.tabControl.activeId()}},{key:"setActiveTab",value:function(t){this.tabControl.activeId(t)&&this._onTabChanged()}},{key:"_onTabChanged",value:function(){var t=this.tabControl.activeId();this.dataView.setVisible(t==ee.Data),this.gridView.setVisible(t==ee.Grid),this.sqlView.setVisible(t==ee.Sql)}}]),e}(),ee={Data:1,Grid:2,Sql:3};te.instance=null,te.Tab=ee;var ne=te;function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oe(t,e){return!e||"object"!==re(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function se(t){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ae=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),oe(this,se(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(e,f),function(t,e,n){e&&ie(t.prototype,e),n&&ie(t,n)}(e,[{key:"getHtml",value:function(){return'\n\t\t\t<div id="'.concat(this.uid,'" class="incompatiblebrowser">\n\t\t\t\tК сожалению, Ваша версия браузера не поддерживается.<br/>\n\t\t\t\tДля открытия шахматки рекомендуется использовать последнюю версию браузеров Google Chrome, Mozilla Firefox или Microsoft Edge.\n\t\t\t</div>')}}]),e}();function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ce=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.records=[],this.objects=[],this._objectsById={},this.sqlModel=new Dt,this.onChanged=new c}return function(t,e,n){e&&le(t.prototype,e),n&&le(t,n)}(t,[{key:"addRecord",value:function(t){this.records.push(t)}},{key:"addObject",value:function(t){this.objects.push(t)}},{key:"removeObject",value:function(t){s.removeFirst(this.objects,t)}},{key:"finish",value:function(){for(var t=0,e=this.records.length;t<e;t++){var n=this.records[t];n.id=t+1,n.objects=[]}this._objectsById={};for(t=0,e=this.objects.length;t<e;t++){var r=this.objects[t];r.id=t+1,this._objectsById[r.id]=r,r.record.objects.push(r)}!function(t){for(var e={},n=0,r=t.length;n<r;n++){var i=t[n];if(i instanceof W&&null!=i.section){var o=fe(fe(fe(fe(e,i.building),i.section),i.floor),i.number,i);o!==i&&(o.duplicate=!0,i.duplicate=!0)}}}(this.objects),this.sqlModel.init(this)}},{key:"swap",value:function(t){var e;e=this.records,this.records=t.records,t.records=e,e=this.objects,this.objects=t.objects,t.objects=e,e=this._objectsById,this._objectsById=t._objectsById,t._objectsById=e,this.sqlModel.swap(t.sqlModel)}},{key:"changed",value:function(){this.onChanged.trigger()}},{key:"getObjectById",value:function(t){return this._objectsById[t]}}]),t}();function fe(t,e,n){return t.hasOwnProperty(e)?t[e]:(void 0===n&&(n={}),t[e]=n,n)}function he(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var pe=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&he(t.prototype,e),n&&he(t,n)}(t,[{key:"load",value:function(t){return $.get(t).then(function(t){return t},function(){return new Error("Не удалось загрузить "+t)})}}]),t}();function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ye=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&de(t.prototype,e),n&&de(t,n)}(t,[{key:"load",value:function(t){var e=$.Deferred();try{var n=new window.FileReader;n.onload=function(t){e.resolve(t.target.result)},n.onerror=function(t){var n="Не удалось загрузить файл";void 0!==t&&(n+=": "+t),e.reject(new Error(n))},n.readAsText(t)}catch(t){e.reject(t)}return e}}]),t}(),be=n(18),ge=n.n(be),me=n(12);function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _e(t,e){return!e||"object"!==ve(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function we(t){var e="function"==typeof Map?new Map:void 0;return(we=function(t){if(null===t||!function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Se(t,arguments,je(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Oe(n,t)})(t)}function Se(t,e,n){return(Se=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Oe(i,n.prototype),i}).apply(null,arguments)}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ee=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=_e(this,je(e).call(this,"Ошибка в строке ".concat(t,": ").concat(n.message)))).line=t,r.innerError=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(e,we(Error)),e}();function ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Re=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._config=e||{}}return function(t,e,n){e&&ke(t.prototype,e),n&&ke(t,n)}(t,[{key:"read",value:function(t,e){var n=this,r=new me.Readable;r.push(t),r.push(null);var i=ge()({delimiter:"\t",relax_column_count:!0});r.pipe(i);var o=this._config.skipRows||0;i.on("readable",function(){for(var t;t=i.read();)o>0?--o:(t=t.map(function(t){return t.trim()}),n._processRecord(t))}),i.on("error",function(t){var r=new Ee(i.lines,t);n._finish(r),e(r)}),i.on("finish",function(){n._finish(null),e(null)})}},{key:"_processRecord",value:function(t){throw new Error("Not implemented")}},{key:"_finish",value:function(t){}}]),t}();function Te(t){return function(t){return t=window.parseFloat(t),isNaN(t)?null:t}(t=t.replace(/,/g,"."))}function Pe(t){var e=i(t);if(null==e)throw new Error("Некорректный номер секции: "+t);return e}function xe(t){var e=i(t);if(null==e)throw new Error("Некорректный номер этажа: "+t);return e}function Ce(t){var e=i(t);if(1!=e&&2!=e)throw new Error("Некорректный номер корпуса: "+t);return e}function Ae(t){var e=i(t);if(null==e)throw new Error("Некорректный номер квартиры: "+t);return e}function Ie(t){var e=i(t);if(null==e)throw new Error("Некорректный номер записи: "+t);return e}function Me(t){var e=Te(t);if(null==e)throw new Error("Некорректное значение площади: "+t);return e}function Ne(t){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function De(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Be(t,e,n){return e&&Le(t.prototype,e),n&&Le(t,n),t}function Ue(t,e){return!e||"object"!==Ne(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qe(t,e,n){return(qe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fe(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Fe(t){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var We=function(t){function e(t){var n;return De(this,e),(n=Ue(this,Fe(e).call(this,{skipRows:1})))._model=t,n._records={},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(e,Re),Be(e,[{key:"read",value:function(t,n){var r=this;qe(Fe(e.prototype),"read",this).call(this,t,function(t){if(!t)for(var e in r._records)r._records.hasOwnProperty(e)&&r._records[e].finish();n(t)})}},{key:"_processRecord",value:function(t){var e=t[3];if(e){e=Ie(e);var n,r,i=t[1];if(!i)throw new Error("Отсутвует строка записи");e in this._records?r=(n=this._records[e]).modelRecord():(r=(n=this._records[e]=new Ye(e)).modelRecord(),this._model.addRecord(r)),n.appendSource(i);var o=t[4];if(o){var s=t[5];s=s&&"бн"!=s?Ae(s):null;var u=Ce(t[6]),a=Me(t[9]);if("машиноместо"!=o){var l=t[8];if(l=l&&"нет"!=l&&"?"!=l?Pe(l):null,"неж пом"==o||o.search(/предприятие/i)>=0||"магазин"==o||"офис"==o)this._model.addObject(new Y(r,o,s,u,l,a));else{var c=xe(t[7]);if(null==s)throw new Error("Некорректный номер объекта: "+t[5]);this._model.addObject(new W(r,o,s,u,c,null,l,a))}}else{if(null==s)throw new Error("Некорректный номер объекта: "+t[5]);this._model.addObject(new F(r,s,u,a))}}else for(var f=5;f<t.length;f++)if(t[f])throw new Error("Строка, не содержащая тип объекта, не должна содержать информации об объекте")}}}]),e}(),Ye=function(){function t(e){De(this,t),this._source=[],this._modelRecord=new B(e,null,null,null)}return Be(t,[{key:"modelRecord",value:function(){return this._modelRecord}},{key:"appendSource",value:function(t){this._source.push(t)}},{key:"finish",value:function(){var t=this._source.join("\n"),e=function(t){var e=t.match(/№\s*(.*?)\s+от\s+(\d+)\.(\d+)\.(\d+)/);if(!e)throw new Error("В записи не найдены регистрационный номер и дата регистрации");var n=e[1],r=i(e[2]),o=i(e[3]),s=i(e[4]),u=new Date(s,o-1,r);return{number:n,date:u}}(t);this._modelRecord.registryNumber=e.number,this._modelRecord.date=e.date,this._modelRecord.source=t}}]),t}();function He(t){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ge(t,e){return!e||"object"!==He(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Je(t){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ve(t,e){return(Ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qe=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ge(this,Je(e).call(this,{skipRows:2})))._model=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ve(t,e)}(e,Re),function(t,e,n){e&&ze(t.prototype,e),n&&ze(t,n)}(e,[{key:"_processRecord",value:function(t){var e=t[0];if(e){e=Ie(e);var n=Ae(t[1]),r=function(t){var e=i(t);if(null==e)throw new Error("Некорректный номер на площадке: "+t);return e}(t[2]),o=xe(t[3]),s=Ce(t[4]),u=Pe(t[5]),a=Me(t[6]),l=t[7];if(!l)throw new Error("Отсутствует владелец: "+t[7]);var c=new U(e,l);this._model.addRecord(c);this._model.addObject(new W(c,"квартира",n,s,o,r,u,a))}}}]),e}();function Xe(t){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ke(t,e){return!e||"object"!==Xe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tn(t){return(tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function en(t,e){return(en=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ke(this,tn(e).call(this,{skipRows:1})))._model=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&en(t,e)}(e,Re),function(t,e,n){e&&Ze(t.prototype,e),n&&Ze(t,n)}(e,[{key:"_processRecord",value:function(t){for(var e=Pe(t[0]),n=xe(t[1]),r=Ae(t[2]),i=Ie(t[3]),o=this._model.objects,s=null,u=0,a=o.length;u<a;u++){var l=o[u];if(l instanceof W&&l.floor==n&&l.number==r&&null==l.section&&l.record.number==i){var c=l.record;if(!(c instanceof B))throw new Error("Найденная запись имеет некорректный тип: "+c.type);if(null!=s)throw new Error("Найдено несколько подходящих записей; должна быть одна");s=l}}if(!s)throw new Error("Запись не найдена");s.section=e}}]),e}();function rn(t){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function on(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sn(t,e){return!e||"object"!==rn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function un(t){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function an(t,e){return(an=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ln=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=sn(this,un(e).call(this,{skipRows:1})))._model=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&an(t,e)}(e,Re),function(t,e,n){e&&on(t.prototype,e),n&&on(t,n)}(e,[{key:"_processRecord",value:function(t){for(var e=Ie(t[0]),n=Ae(t[1]),r=this._model.objects,i=null,o=0,s=r.length;o<s;o++){var u=r[o];if(u instanceof W&&u.record.number==e&&u.number==n){if(null!=i)throw new Error("Найдено несколько подходящих записей; должна быть одна");i=u}}if(!i)throw new Error("Запись не найдена");this._model.removeObject(i)}}]),e}();function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hn(t,e){return!e||"object"!==cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pn(t){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dn(t,e){return(dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=hn(this,pn(e).call(this,{skipRows:1})))._model=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dn(t,e)}(e,Re),function(t,e,n){e&&fn(t.prototype,e),n&&fn(t,n)}(e,[{key:"_processRecord",value:function(t){for(var e=0,n=t.length;e<n;e++)if(t[e]=i(t[e]),null==t[e])throw new Error("Значения должны быть числовыми");var r=t[0],o=t[1],s=t[2],u=t[3],a=t[4],l=t[5],c=t[6],f=this._model.objects,h=0;for(e=0,n=f.length;e<n;e++){var p=f[e];p instanceof W&&p.section>=r&&p.section<=o&&p.floor>=s&&p.floor<=u&&p.number>=a&&p.number<=l&&(p.setNumber(p.number+c),h++)}if(0==h)throw new Error("Не найдено ни одной подходящей записи")}}]),e}();function bn(t){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mn(t,e){return!e||"object"!==bn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vn(t){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _n(t,e){return(_n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wn(t,e){var n=t.source.match(/Участники долевого\n(.*?)(\n|$)/i);if(!n)throw new Error("В записи не найдены данные об участниках долевого строительства");var r=n[1].toLowerCase();e.some(function(t){return r.indexOf(t)>=0})||(t.owner=r)}var Sn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=mn(this,vn(e).call(this,{skipRows:1})))._model=t,n._searchStrings=[],n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_n(t,e)}(e,Re),function(t,e,n){e&&gn(t.prototype,e),n&&gn(t,n)}(e,[{key:"_processRecord",value:function(t){this._searchStrings.push(t[0].toLowerCase())}},{key:"_finish",value:function(){for(var t=this._model.records,e=0,n=t.length;e<n;e++){var r=t[e];r instanceof B&&wn(r,this._searchStrings)}}}]),e}();function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var jn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._model=e,this.participantsRegistryUrl="data/ЕГРП.csv",this.ownersRegistryUrl="data/Собственники.csv",this.incorrectApartmentsUrl="data/Некорректные записи-дубликаты.csv",this.apartmentsWithoutSectionUrl="data/Квартиры без номера секции.csv",this.oldApartmentNumbersUrl="data/Старые номера квартир.csv",this.juridicalPersonsUrl="data/Юридические лица.csv",this._participantsRegistry=null,this._ownersRegistry=null,this._apartmentsWithoutSection=null,this._incorrectApartments=null,this._oldApartmentNumbers=null,this._juridicalPersons=null,this._ajaxLoader=new pe,this._fileLoader=new ye,this._opCounter=0,this.onOperationStart=new c,this.onOperationEnd=new c}return function(t,e,n){e&&On(t.prototype,e),n&&On(t,n)}(t,[{key:"init",value:function(){var t=this;return t._operation(function(){return $.Deferred().resolve().then(function(){return t.loadDefaultParticipantsRegistry()}).then(function(){return t.loadDefaultOwnersRegistry()}).then(function(){return t.loadDefaultApartmentsWithoutSection()}).then(function(){return t.loadDefaultIncorrectApartments()}).then(function(){return t.loadDefaultOldApartmentNumbers()}).then(function(){return t.loadDefaultJuridicalPersons()}).then(function(){return t.updateModel()})})}},{key:"loadDefaultParticipantsRegistry",value:function(){var t=this,e=this;return e._operation(function(){return e._ajaxLoader.load(t.participantsRegistryUrl).then(function(t){e._participantsRegistry=t})})}},{key:"loadDefaultOwnersRegistry",value:function(){var t=this,e=this;return e._operation(function(){return e._ajaxLoader.load(t.ownersRegistryUrl).then(function(t){e._ownersRegistry=t})})}},{key:"loadDefaultApartmentsWithoutSection",value:function(){var t=this,e=this;return e._operation(function(){return e._ajaxLoader.load(t.apartmentsWithoutSectionUrl).then(function(t){e._apartmentsWithoutSection=t})})}},{key:"loadDefaultIncorrectApartments",value:function(){var t=this,e=this;return e._operation(function(){return e._ajaxLoader.load(t.incorrectApartmentsUrl).then(function(t){e._incorrectApartments=t})})}},{key:"loadDefaultOldApartmentNumbers",value:function(){var t=this,e=this;return e._operation(function(){return e._ajaxLoader.load(t.oldApartmentNumbersUrl).then(function(t){e._oldApartmentNumbers=t})})}},{key:"loadDefaultJuridicalPersons",value:function(){var t=this,e=this;return e._operation(function(){return e._ajaxLoader.load(t.juridicalPersonsUrl).then(function(t){e._juridicalPersons=t})})}},{key:"loadApartmentsWithoutSection",value:function(t){var e=this;return e._operation(function(){return e._fileLoader.load(t).then(function(t){e._apartmentsWithoutSection=t})})}},{key:"loadIncorrectApartments",value:function(t){var e=this;return e._operation(function(){return e._fileLoader.load(t).then(function(t){e._incorrectApartments=t})})}},{key:"loadOldApartmentNumbers",value:function(t){var e=this;return e._operation(function(){return e._fileLoader.load(t).then(function(t){e._oldApartmentNumbers=t})})}},{key:"loadJuridicalPersons",value:function(t){var e=this;return e._operation(function(){return e._fileLoader.load(t).then(function(t){e._juridicalPersons=t})})}},{key:"updateModel",value:function(){var t=this,e=new ce;return t._operation(function(){return $.Deferred().resolve().then(function(){return En("данные из ЕГРП",t._participantsRegistry,new We(e))}).then(function(){return En("данные из реестра собственникам долей",t._ownersRegistry,new Qe(e))}).then(function(){return En("данные по квартирам без номера секции",t._apartmentsWithoutSection,new nn(e))}).then(function(){return En("данные по некорректным записям-дубликатам",t._incorrectApartments,new ln(e))}).then(function(){return En("данные по старым номерам квартир",t._oldApartmentNumbers,new yn(e))}).then(function(){return En("данные по юридическим лицам",t._juridicalPersons,new Sn(e))}).then(function(){try{e.finish()}catch(t){return $.Deferred().reject(t)}t._model.swap(e),t._model.changed()})})}},{key:"_operation",value:function(t){var e=this;return e._operationStart(),t().done(function(){e._operationEnd()}).fail(function(t){e._operationEnd(t)})}},{key:"_operationStart",value:function(){0==this._opCounter++&&this.onOperationStart.trigger()}},{key:"_operationEnd",value:function(t){this._opCounter=Math.max(1,this._opCounter),0==--this._opCounter&&this.onOperationEnd.trigger(t)}}]),t}();function En(t,e,n){var r=$.Deferred();return e?(n.read(e,function(t){t?r.reject(t):r.resolve()}),r):r.reject(new Error("Отсутствуют "+t))}$(/MSIE/.test(navigator.userAgent)||/Trident/.test(navigator.userAgent)||!Modernizr.flexwrap?function(){(new ae).install($(document.body))}:function(){var t=new ce,e=new jn(t),n=new ne(t,e);n.install($(document.body)),e.init().then(function(){n.getActiveTab()||n.setActiveTab(ne.Tab.Grid)},function(){n.getActiveTab()||n.setActiveTab(ne.Tab.Data)})})}]);
//# sourceMappingURL=app.js.map