var View = require("app/views/View");

class GridView extends View {
	constructor(model) {
		super();
		var me = this;

		var searchModel = new SearchModel();
		var recordSelectionModel = new RecordSelectionModel();
		me.filters = me.addChild(new Filters(model, searchModel));
		me.grid = me.addChild(new Grid(model, searchModel, recordSelectionModel));

		// handle this signal here to control the order of child views' updates
		model.onChanged.bind(function() {
			recordSelectionModel.clear();
			searchModel.onChanged.mute();
			me.filters.apply();
			searchModel.onChanged.mute(-1);
			me.grid.redraw();
		});
	}
	getHtml() {
		return `
			<div id="${this.uid}" class="gridview">
				${this.filters.getHtml()}
				${this.grid.getHtml()}
			</div>
		`;
	}
}

module.exports = GridView;

var Grid = require("app/views/Grid");
var Filters = require("app/views/Filters");
var SearchModel = require("app/model/SearchModel");
var RecordSelectionModel = require("app/model/RecordSelectionModel");
